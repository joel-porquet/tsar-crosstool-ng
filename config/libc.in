# C library options

config LIBC
    string
    default "none"   if BARE_METAL
    default "glibc"  if LIBC_GLIBC
    default "eglibc" if LIBC_EGLIBC
    default "uClibc" if LIBC_UCLIBC

if ! BARE_METAL

menu "C-library"

config LIBC_VERSION
    string
    help
      Enter the date of the snapshot you want to use in the form: YYYYMMDD
      where YYYY is the 4-digit year, MM the 2-digit month and DD the 2-digit
      day in the month.
      
      Please note:
      - glibc has snapshots done every monday, and only the last ten are kept.
      - uClibc has daily snapshots, and only the last 30-or-so are kept.
      
      So if you want to be able to re-build your toolchain later, you will
      have to save your C library tarball by yourself.

choice
    bool
    prompt "C-library to use:"
    default LIBC_GLIBC

config LIBC_GLIBC
    bool
    prompt "glibc"
    select LIBC_SUPPORT_NPTL
    select LIBC_SUPPORT_LINUXTHREADS

config LIBC_EGLIBC
    bool
    prompt "eglibc (EXPERIMENTAL)"
    select LIBC_SUPPORT_NPTL
    select LIBC_SUPPORT_LINUXTHREADS
    depends on EXPERIMENTAL
    help
      EGLIBC (Embedded GLIBC) is a variant of the standard GNU GLIBC
      that is designed to work well on embedded systems.  EGLIBC strives
      to be source and binary compatible with GLIBC.  Its goals include
      a reduced footprint, configurable components, and improved
      cross-compilation support.  EGLIBC also includes some embedded ports
      (such as e500/spe) that are normally separate add-ons of GLIBC.

config LIBC_UCLIBC
    bool
    prompt "uClibc"
    select LIBC_SUPPORT_LINUXTHREADS

endchoice

comment "Common C library options"

config LIBC_SUPPORT_NPTL
    bool
    default n

config LIBC_SUPPORT_LINUXTHREADS
    bool
    default n

config THREADS
    string
    default "nptl"          if THREADS_NPTL
    default "linuxthreads"  if THREADS_LINUXTHREADS
    default "none"          if THREADS_NONE

choice
    bool
    prompt "Threading implementation to use:"
    default THREADS_NPTL           if LIBC_SUPPORT_NPTL
    default THREADS_LINUXTHREADS   if LIBC_SUPPORT_LINUXTHREADS && ! LIBC_SUPPORT_NPTL
    default THREADS_NONE           if ! LIBC_SUPPORT_LINUXTHREADS && ! LIBC_SUPPORT_NPTL

config THREADS_NPTL
    bool
    prompt "nptl"
    depends on LIBC_SUPPORT_NPTL

config THREADS_LINUXTHREADS
    bool
    prompt "linuxthreads"
    depends on LIBC_SUPPORT_LINUXTHREADS

config THREADS_NONE
    bool
    prompt "none"

endchoice

if LIBC_GLIBC
source config/libc/glibc.in
endif

if LIBC_EGLIBC
source config/libc/eglibc.in
endif

# Hack: mconf does not allow to include a file multiple times,
# so include glibc and eglibc common options from here, rather
# than from each config files.
if LIBC_GLIBC || LIBC_EGLIBC
source config/libc/glibc-eglibc-common.in
endif

if LIBC_UCLIBC
source config/libc/uClibc.in
endif

endmenu

endif # ! BARE_METAL
